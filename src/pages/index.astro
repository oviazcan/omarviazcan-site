---
import SiteLayout from "../layouts/SiteLayout.astro";
import AlbumCard from "../components/AlbumCard.astro";
import { getCollection } from "astro:content";

const albums = await getCollection("albums");
const featured = albums.find(a => a.data.featured) ?? albums.sort((a,b)=>b.data.year-a.data.year)[0];
---

<SiteLayout title="Omar Viazcán" description="Música original, álbumes, blog y contacto.">
  <section class="card" style="padding:24px;">
    <div style="display:flex;gap:18px;flex-wrap:wrap;align-items:center;">
      <div style="flex:1;min-width:260px;">
        <div class="badge">Músico • compositor • grabación casera con estándares indecentes</div>
        <h1 style="margin:14px 0 10px;font-size:40px;line-height:1.1;">Omar Viazcán</h1>
        <p style="margin:0;color:var(--muted);max-width:62ch;">
          Un sitio simple: lo nuevo, la discografía, escucha gratuita y un blog para documentar el proceso sin fingir que todo es “marketing”.
        </p>
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:18px;">
          <a class="badge" href="/links">Escuchar</a>
          <a class="badge" href="/albums">Ver álbumes</a>
          <a class="badge" href="/blog">Blog</a>
          <a class="badge" href="/contact">Contacto</a>
        </div>
      </div>

      {featured && (
        <div style="min-width:320px;flex:0 0 360px;">
          <h2 style="margin:0 0 10px;">Último / Destacado</h2>
          <AlbumCard
            title={featured.data.title}
            year={featured.data.year}
            cover={featured.data.cover}
            featured={true}
            href={`/albums/${featured.slug}/`}
          />
        </div>
      )}
    </div>
  </section>

  <section style="margin-top:22px;">
    <h2 style="margin:0 0 10px;">Secciones</h2>
    <div class="grid grid-3">
      <a class="card" href="/albums">
        <h3 style="margin:0 0 8px;">Discografía</h3>
        <p style="margin:0;color:var(--muted);">Álbumes, links, tracklists y notas.</p>
      </a>
      <a class="card" href="/gallery">
        <h3 style="margin:0 0 8px;">Galería</h3>
        <p style="margin:0;color:var(--muted);">Fotos y detrás de cámaras.</p>
      </a>
      <a class="card" href="/blog">
        <h3 style="margin:0 0 8px;">Blog</h3>
        <p style="margin:0;color:var(--muted);">Bitácora de proceso, letras e ideas.</p>
      </a>
    </div>
  </section>
</SiteLayout>
